---
title: LINUX-SHELL
tags: [linux]
sitemap:
    lastmod: 2015-10-24T12:49:30-05:00
---



编写简单的shell脚本 
=====================================================================

```shell
  #!/bin/bash
  #第一行标注shell种类
  $str="hello,world"
  unset str
  #变量用完之后使用unset命令将其从内存中移除
```

  让脚本可执行
    chmod +x myscript.sh






shell种类
=====================================================================

登录shell
------------------------------------------

*    任何在登录时创建的shell（包括X登录）
*    su-：      登录后自动切换至其家目录
*    ssh



非登录shell
------------------------------------------

*    su：      登录后不切换至其家目录
*    图形终端
*    执行脚本
*    其它bash实例






bash启动和退出
=====================================================================

profile
------------------------------------------

###    保存在

*      /etc/profile
        全局
*      ~/.bash_profile
        用户
###    作用

*      登录shell启动时自动执行
*      设置环境变量
*      执行命令
        邮件检查脚本



bashrc
------------------------------------------

###    保存在

*      /etc/bashrc
        全局
*      ~/.bashrc
        用户


###    作用

*      所有shell启动时自动执行
*      设置环境变量
*      定义别名



~/.bash_logout
------------------------------------------

###    登录shell退出时自动执行

###    用于
*      创建自动备份
*      清除临时文件






脚本参数
=====================================================================

*  位置参数
    $1,$2,$3
*  $*
    所有命令行参数
*  $#
    命令行参数个数
*  $?
    上一命令结果






脚本调试
=====================================================================

  set -X
  set +x






命令扩展
=====================================================================

扩展种类
------------------------------------------

###    通配符扩展

*      ls file*
*      ls file?
        ?代表任意单个（不能为0）字符
*      ls file[^12]?


###    命令扩展为变量

*      $()
*      一对反引号''


###    大括号扩展

*      touch file{1,2,3,11,22,33}



扩展顺序
------------------------------------------

###    把命令行分隔成单词

*      扩展别名
*      扩展分支陈述
        {}
*      扩展标题陈述
        ~
*      扩展变量和命令替代
        $
        $()
        反引号``


###    把命令行再次分隔成单词

*      扩展文件通配符
        *
        ?
        [abc]
*      预务I/O重定向
        <
        >


###    执行命令！



阻止扩展
------------------------------------------

*    斜线（\）让下一个字符合法
*    引号阻止扩展
 *     单引号'
        抑制所有扩展
 *     双引号"
        抑制所有扩展，除了
          $
          反引号`
          \
          !
            历史替代






命令组合
=====================================================================

使用重定向连接命令和文件
------------------------------------------

*    >
      重定向STDOUT
*    2> /dev/null
      重定向STDERR
*    &>
      重定向所有
*    2>&1
      重定向STDERR到STDOUT
*    (;)
      结合多个STDOUT
        (cal 2007 ; cal 2008) | less
*    tr 'A-Z' 'a-z' < file1.txt
*    <<WORD
      重定向多行至STDIN



使用管道连接两个命令
------------------------------------------

*    echo "hello" | mail -s "hello" user1
*    tee重定向至多个目标
    command1 | tee [-a] filename | command2



控制
------------------------------------------

*    if
      当then与if写在同一行时，前面加;
*    for循环
      for NAME in joe jane julie
      for NUM in $(seq 1 10)
      for FILE in *.txt



使用分号隔开两个命令
------------------------------------------

    前一个命令的执行错误不会影响下一个命令的执行






常用命令
=====================================================================

source命令
------------------------------------------

*    在当前的shell环境下执行指定文件中的命令，而非开启一个子shell进行执行
*    用于重新设置当前shell的环境变量
*    不管目标文件有没有执行权限
*    可用”.“代替



cd - 切换至上一个工作目录
------------------------------------------



sudo可运行的命令需要在/etc/sudoers文件中手动为非特权用户开户
------------------------------------------



read命令
------------------------------------------

*    分配输入值给多个shell变量
*    其它剩余的词被分配给最后一个变量
*    -p
      指明提示符显示
*    read -p "Enter a file name: " FILE



alias
------------------------------------------

    查看所有设置的别名






命令行历史
=====================================================================

*  history命令
*  按ctrl-r从历史中搜索命令
*  重调上一个参数
    Esc-.
    Alt-.
    !$
      仅上一个命令有效
*  !<历史命令中的前面部分字符>






命令编辑技巧
=====================================================================

*  tab命令快捷键帮助完成
*  ctrl-a
    移动到行的开始位置
*  ctrl-e
    移动到行的最后位置
*  ctrl-u
    删除到行的开始位置
*  ctrl-k
    删除到行的最后位置
*  ctrl-方向键
    逐个单词移动






环境变量
=====================================================================

局部
------------------------------------------

    用VARIABLE=VALUE方式设置



导出
------------------------------------------

    用export VARIABLE=VALUE方式设置



公共变量
------------------------------------------

###    配置变量

*      PS1
        bash提示符的显示
*      PATH
        查找可执行文件的目录
*      EDITOR
        默认的文本编辑器
*      HISTFILESIZE
        保存在bash历史的命令数目


###    信息变量

*      HOME
        用户的HOME目录
*      EUID
        用户的有效UID






备注
=====================================================================

*  ~<用户名> 指向其他用户的主目录
*  单字符参数可以直接组合